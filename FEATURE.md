# 需求说明

## 日志查看器改版需求说明

日志模块暂时移除

- [ ] 日志查看器不再使用 websocket，因为离开页面后日志就不记录了，直接存数据库，然后从数据库轮询读取（5s 一次应该差不多了）
- [ ] 日志数据库 jsonl 改为 sqlite
- [ ] 目前看所有数据都可以从日志读取，不如所有页面直接统一读取日志进行分析，统一数据来源
- [ ] status_code_raw 显示在日志查看器中（Codex 历史记录搜索“dashboard 和 monitoring 的请求列表中”可继续）

### 第一版
- 日志数据库 jsonl 改为 sqlite，数据库文件名就叫 running_log 就行了，是专门用于记录运行日志的
- 日志查看器不再使用 WebSocket，因为离开页面后日志就没法记录了，我需要的是只要后端有运行，日志就要一直记录
- 日志直接存入数据库，然后日志查看器通过后端接口从数据库轮询读取，每 5s 读取一次
- 不需要兼容原来的数据

## 配置管理改版需求说明

### 第一版

- [x] 配置管理页面改版，允许自定义配置
    - 保存后提示自动重启后端服务

### 第二版

- [x] 配置保存位置改为 ./env/.env
- [x] DASHBOARD_API_KEY 变量为空时，隐藏“编辑配置”按钮
- [x] 不隐藏“编辑配置”按钮了，改为：DASHBOARD_API_KEY 变量为空时，点击“编辑配置”按钮提示“管理员未开启密钥认证”
- [ ] 禁止在前端页面修改 DASHBOARD_API_KEY

### 第三版

- [ ] 配置保存在数据库，移除 .env，初始化数据也在数据库